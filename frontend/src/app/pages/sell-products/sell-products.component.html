<h1>Witaj {{ authService.getUsername() }}</h1>
<form>
  <div class="row">
    <div class="col">
      <input
        class="form-control"
        type="number"
        name="productCode"
        #productCodeControl
        [(ngModel)]="productCode"
      />
    </div>
    <div class="col">
      <button (click)="getProduct()" class="btn btn-primary" type="submit">
        Wyszukaj
      </button>
    </div>
    <div class="col">
      <button
        (click)="submitSell()"
        [disabled]="products.length === 0 || !this.paymentMethod"
        class="btn btn-warning w-100"
      >
        Zakończ sprzedaż
      </button>
    </div>
  </div>
</form>
<div class="overflow-auto mt-5">
  <table class="table">
    <thead>
      <tr>
        <td>Lp.</td>
        <td>Kod</td>
        <td>Nazwa</td>
        <td>Cena/szt</td>
        <td>Ilość</td>
        <td>Suma</td>
        <td>Opcje</td>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of products; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ product.code }}</td>
        <td>{{ product.short_name }}</td>
        <td class="currency-addon">{{ product.price }}</td>
        <td>
          <input
            class="form-control"
            name="productAmount"
            [(ngModel)]="product.amount"
            min="1"
            type="number"
          />
        </td>
        <td class="currency-addon">
          {{ (product.price * product.amount).toFixed(1) }}
        </td>
        <td>
          <button (click)="removeProduct(i)" class="btn btn-danger">
            usuń
          </button>
        </td>
      </tr>
      <tr>
        <td colspan="5">SUMA</td>
        <td class="currency-addon">{{ sum.toFixed(1) }}</td>
      </tr>
      <tr>
        <td colspan="5">Zapłata</td>
        <td class="position-relative">
          <input
            class="form-control"
            type="number"
            name="amountPayed"
            [(ngModel)]="amountPayed"
            min="0"
          />
          <span class="currency-field-addon">PLN</span>
        </td>
      </tr>
      <tr>
        <td colspan="5">Reszta</td>
        <td
          class="currency-addon"
          id="change"
          [ngClass]="{ 'text-danger': amountPayed - sum > 0 }"
        >
          {{ amountPayed - sum < 0 ? 0 : (amountPayed - sum).toFixed(1) }}
        </td>
      </tr>
      <tr>
        <td colspan="5">Metoda płatności</td>
        <td>
          <div class="form-check d-flex align-items-center">
            <input
              [(ngModel)]="paymentMethod"
              value="CASH"
              class="form-check-input"
              type="radio"
              name="paymentMethod"
              id="cash"
            />
            <label class="form-check-label" for="cash">
              <img
                src="assets/money.png"
                width="50px"
                height="50px"
                alt="obrazek z pieniędzmi"
              />
              Gotówka
            </label>
          </div>
          <div class="form-check d-flex align-items-center">
            <input
              [(ngModel)]="paymentMethod"
              value="BLIK"
              class="form-check-input"
              type="radio"
              name="paymentMethod"
              id="blik"
            />
            <label class="form-check-label" for="blik">
              <img
                src="assets/blik.svg"
                width="50px"
                height="50px"
                alt="obrazek z pieniędzmi"
              />
              BLIK
            </label>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
